version: 2.1
orbs:
  slack: circleci/slack@4.6.1
  run-with-retry: kimh/run-with-retry@1.0.0  
#test
jobs:
  build:
    working_directory: ~/circleci-demo-python-django
    docker:
      - image: cimg/base:2020.01
    steps:
      - restore_cache:
          keys:
          - v{{ .Environment.CIRCLE_CACHE_VERSION }}-git-{{ .Branch }}-{{ .Revision }}
      - checkout
#       - save_cache:
#           key: v{{ .Environment.CIRCLE_CACHE_VERSION }}-git-{{ .Branch }}-{{ .Revision }}
#           paths:
#           - .git
  test:
    working_directory: ~/circleci-demo-python-django
    docker:
      - image: cimg/base:2020.01
    steps:
      - restore_cache:
          keys:
          - v{{ .Environment.CIRCLE_CACHE_VERSION }}-git-{{ .Branch }}-{{ .Revision }}
      - checkout
#       - save_cache:
#           key: v{{ .Environment.CIRCLE_CACHE_VERSION }}-git-{{ .Branch }}-{{ .Revision }}
#           paths:
#           - .git




workflows:
  my_workflow:
    jobs:
      - build
      - test
 

